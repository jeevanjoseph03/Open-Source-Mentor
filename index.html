<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beginner Friendly Issues</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    h1 { font-size: 1.5rem; }
    input, button { padding: 8px; font-size: 1rem; margin-top: 10px; }
    ul { list-style: none; padding-left: 0; }
    li { margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Find Beginner-Friendly Issues</h1>

  <p>Optionally paste your GitHub token here to avoid rate-limits:</p>
  <input id="token" placeholder="GitHub Token (optional)" style="width:100%">

  <button onclick="loadIssues()">Load my issues</button>

  <h2>Issues for your top language:</h2>
  <ul id="issues"></ul>

  <script>
    async function loadIssues() {
      const token = document.getElementById('token').value.trim();
      const headers = token ? { Authorization: `token ${token}` } : {};

      // 1. Get your repos
      const reposRes = await fetch('https://api.github.com/user/repos?per_page=100', { headers });
      if (!reposRes.ok) {
        alert('Error fetching repos. If you see 401, you need a token.');
        return;
      }
      const repos = await reposRes.json();

      // 2. Count languages
      const langCount = {};
      repos.forEach(r => {
        if (r.language) {
          langCount[r.language] = (langCount[r.language] || 0) + 1;
        }
      });
      const topLang = Object.entries(langCount).sort((a, b) => b[1] - a[1])[0]?.[0] || 'JavaScript';

      // 3. Build search query with multiple label variants
      const query = `state:open+language:${encodeURIComponent(topLang)}+(label:"good first issue" OR label:good-first-issue OR label:beginner)`;

      // 4. Fetch issues
      const issuesRes = await fetch(
        `https://api.github.com/search/issues?q=${query}&sort=updated&order=desc&per_page=5`,
        { headers }
      );
      if (!issuesRes.ok) {
        alert('Error fetching issues');
        return;
      }
      const issues = await issuesRes.json();

      // 5. Show them
      const ul = document.getElementById('issues');
      ul.innerHTML = '';
      issues.items.forEach(issue => {
        const li = document.createElement('li');
        li.innerHTML = `<a href="${issue.html_url}" target="_blank">${issue.title}</a> <small>(${issue.repository_url.split('/').slice(-2).join('/')})</small>`;
        ul.appendChild(li);
      });
    }
  </script>
</body>
</html>
